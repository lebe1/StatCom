---
title: "Case Study 1 Group 97"
author: "Farmohammadi Pouya, Monteiro Oliveira Guilherme, Beccard Leon"
date: "2024-03-27"
output: html_document
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)
```

## Task 1 Ratio of Fibonacci numbers

### a)  
Write two different R functions which return the sequence ri = Fi+1 /Fi for i = 1, . . . , n where Fi is the ith
Fibonacci number, once using for and once using while.

For understanding the sequence, it is as follows  
Fibonacci sequence:   0,1,1,2,3,5,8,13,21,..., with 0 as F0 

* r1 = F2/F1 = 1/1 = 1  
* r2 = F3/F2 = 2/1 = 2  
* r3 = F4/F3 = 3/2 = 1.5

**For loop**

```{r fib_ratio_for}
fib_ratio_for <- function(n) {
  # Check for bad inputs
  if (n <= 0) {
    stop("Input 'n' cannot be 0 or negative.")
  } else if (n == 1) {
    # Catch case of n = 1 due to a leading error if not implemented
    return(1)
  } else {
    # numeric vector created with length n + 1 
    # to store the Fibonacci sequence up to the (n + 1)th element.
    fibonacci <- numeric(n + 1) 
    # Assign values (1,1) as first two elements
    fibonacci[1:2] <- c(1, 1)
    # for loop that iterates over the sequence 3:(n + 1)
    # starting from 3 because first two elements are already declared
    for (i in 3:(n + 1)) {
      # Assigning Fibonacci rule to get the next number out of the last two
      fibonacci[i] <- fibonacci[i - 1] + fibonacci[i - 2]
    }
    # Finally calculate the ratio of each fibonacci number
    ratios <- fibonacci[2:(n + 1)] / fibonacci[1:n]
    return(ratios)
  }
}
```

Execute for loop:
```{r fib_ratio_for(5)}
fib_ratio_for(5)
```

**While loop**
```{r fib_ratio_while}
fib_ratio_while <- function(n) {
  if (n <= 0) {
    stop("Input 'n' cannot be 0 or negative.")
  } else if (n == 1) {
    return(1)
  } else {
    fibonacci <- numeric(n + 1)
    fibonacci[1:2] <- c(1, 1)
    i <- 3
    while (i <= n + 1) {
      fibonacci[i] <- fibonacci[i - 1] + fibonacci[i - 2]
      i <- i + 1
    }
    ratios <- fibonacci[2:(n + 1)] / fibonacci[1:n]
    return(ratios)
  }
}
```

Execute while loop:
```{r fib_ratio_while(7)}
fib_ratio_while(7)
```

### b)
Benchmark the two functions for n = 200 and n = 2000 (you can use package microbenchmark or package
bench for this purpose). Which function is faster?

```{r benchmark}
# install.packages('microbenchmark')
library(microbenchmark)

microbenchmark(
  fib_ratio_for(200),
  fib_ratio_while(200),
  fib_ratio_for(2000),
  fib_ratio_while(2000)
)
```

**Explanation for statistics given from microbenchmark**  
min: Minimum time it took to execute  
lq: Lower quartile (25th percentile) time it took to execute  
mean: Mean time it took to execute  
median: Median time it took to execute  
uq: Upper quartile (75th percentile) time it took to execute  
max: Maximum time it took to execute  
neval: Number of times each expression was evaluated  


**Answer:** As given from the stats, the function using the for loop is faster.


### c)

Plot the sequence for n = 100. For which value n it starts to converge?  
What is the number that it converges
to?

```{r plot}
# Calculate the sequence for n = 100
sequence <- fib_ratio_for(100)

# Plot the sequence
plot(sequence, type = "l", xlab = "Index (i)", ylab = "Ratio (r_i)",
     main = "Sequence of Fibonacci Ratios for n = 100")

```

```{r tail_sequence}
# Get the last 6 values to know what number it converges to
tail(sequence)
```

**Answer:** It converges towards the 1.618034. The so-called golden ratio.

## Task 4 Game of craps

A variation of game of craps is played as follows. The player rolls a die and if they roll a 6, they immediately
wins. If a 1 is rolled, they immediately loses. If a 2, 3, 4, or 5 is rolled, then this number becomes their “point
number.’ ’ The player then has up to three more rolls of the die to roll their point number again. If they do,
they win otherwise they lose. Write a program in R to simulate a game of craps. Explain the steps of your
program. If the code is not explained, no points will be earned.

```{r game_of_crabs}
# Define the function for a game of crabs
game_of_craps <- function(){
    # Function to get a random number between 1 and 6 i.e. rolling the dice once
    dice_number <- floor(runif(1, min=1, max=7))
    # check for win or lose condition in first attempt
    if (dice_number == 1){
      return("Sorry, you lost!")
    }
    else if (dice_number == 6){
      return("Yeah, you won in the first attempt!")
    }
    else {
      # for loop to have three more attempts to roll the same 'point number'
      for (i in 1:3){
        # Function to get a random number between 1 and 6 i.e. rolling the dice once
        new_dice_number <- floor(runif(1, min=1, max=7))
        # Check for same 'point number'
        if (dice_number == new_dice_number){
          return("Yeah, you won rolling the same 'point number' again!")
        }
    }
  } 
  return("Sorry, you lost after three more attempts!")
}

# Execute function i.e. one simulation of the game
game_of_craps()

```